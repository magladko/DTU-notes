## Dependent Values

<div class="note example"><h4 class="name">Safe Div By N</h4><p>Consider the case in <code>Dependent.safeDivByN</code>:</p><pre><code class="language-Java hljs" lang="Java" data-highlighted="yes"><span class="hljs-meta">@Case("(0) -&gt; ok")</span>
<span class="hljs-meta">@Case("(1) -&gt; ok")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">safeDivByN</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> { 
  <span class="hljs-keyword">if</span> (n != <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / n;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre><p>If we run our sign analysis naively on the decompiled code we get the following. The offset column shows the offset, the instruction column, shows the instruction column, and the abstract state column shows abstract state right before the instruction and at what instructions the results are put.</p><table><thead><tr><th>Offset</th><th>Instruction</th><th>Abstract State</th></tr></thead><tbody><tr class="fragment"><td><code>000</code></td><td><code>load:I 0</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mi>Ïµ</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>001</code></td><td><code>ifz eq 6</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>2</mn><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>002</code></td><td><code>push:I 1</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mi>Ïµ</mi><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>3</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>003</code></td><td><code>load:I 0</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mn>3</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>4</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>004</code></td><td><code>binary:I div</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo stretchy="true" form="postfix">}</mo></mrow><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mn>4</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>5</mn><mo>,</mo><mrow><mtext mathvariant="normal">err</mtext><mo stretchy="false" form="prefix">(</mo><mtext mathvariant="monospace">â€˜ğšğš’ğšŸ ğš‹ğš¢ ğš£ğšğš›ğš˜â€™</mtext><mo stretchy="false" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>005</code></td><td><code>return:I</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mn>5</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtext mathvariant="normal">ok</mtext><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>006</code></td><td><code>push:I 0</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mi>Ïµ</mi><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>7</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>007</code></td><td><code>return:I</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mn>7</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtext mathvariant="normal">ok</mtext><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr></tbody></table><p>The problem with the above execution is that we find a divide by zero error, even though it does not exist. This happens because we do not capture the dependency between the integer on the stack and in the locals in the choice in 001.</p></div>

To fix this we need to add a notion of named values and constraints

<table><thead><tr><th>Offset</th><th>Instruction</th><th>Abstract State</th></tr></thead><tbody><tr class="fragment"><td><code>000</code></td><td><code>load:I 0</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo>âŠ¢</mo><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mi>Ïµ</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>001</code></td><td><code>ifz eq 6</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo>âŠ¢</mo><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mi>n</mi><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>2</mn><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>002</code></td><td><code>push:I 1</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>âŠ¢</mo><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mi>Ïµ</mi><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>3</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>003</code></td><td><code>load:I 0</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>âŠ¢</mo><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mn>3</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>4</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>004</code></td><td><code>binary:I div</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>âŠ¢</mo><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo stretchy="true" form="postfix">}</mo></mrow><mi>n</mi><mo>,</mo><mn>4</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>5</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>005</code></td><td><code>return:I</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>âŠ¢</mo><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>+</mi><mo>,</mo><mi>âˆ’</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mn>5</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtext mathvariant="normal">ok</mtext><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>006</code></td><td><code>push:I 0</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo>âŠ¢</mo><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mi>Ïµ</mi><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>7</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr><tr class="fragment"><td><code>007</code></td><td><code>return:I</code></td><td><span><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo>âŠ¢</mo><mrow><mo stretchy="true" form="prefix">âŸ¨</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo>â†¦</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>0</mn><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mn>7</mn><mo stretchy="true" form="postfix">âŸ©</mo></mrow><mo>â†’</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtext mathvariant="normal">ok</mtext><mo stretchy="true" form="postfix">}</mo></mrow></mrow></math></span></td></tr></tbody></table>

A couple of things to keep in mind when using named values, is that
- **They should not change.** Which means that if a variable, like a local is overridden, we need to create a new named value, so that values copied out of the locals do not change, when the original variable change.
- Try to be smart about when to create named values and when to remove them again, as too many named variables might make your analysis slow.
- Try to think about what instructions that create dependencies between values. Some examples areÂ `dup`Â andÂ `load`, but array and field accesses does the same.

